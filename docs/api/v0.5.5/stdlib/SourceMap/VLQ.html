<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: SourceMap::VLQ
  
    &mdash; stdlib (Opal v0.5.5)
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "SourceMap::VLQ";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  <span class="title"><a href="/docs">Opal Docs</a></span>
  
    &raquo;
    <a href="../_index.html">Index (V)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../SourceMap.html" title="SourceMap (class)">SourceMap</a></span></span>
     &raquo; 
    <span class="title">VLQ</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: SourceMap::VLQ
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>opal/stdlib/source_map/vlq.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Support for encoding/decoding the variable length quantity format
described in the spec at:</p>

<p><a href="https://docs.google.com/document/d/1U1RGAehQwRypUTovF1KRlpiOFze0b-_2gc6fAH0KY0k/edit">https://docs.google.com/document/d/1U1RGAehQwRypUTovF1KRlpiOFze0b-_2gc6fAH0KY0k/edit</a></p>

<p>This implementation is heavily based on <a href="https://github.com/mozilla/source-map">https://github.com/mozilla/source-map</a>
Copyright 2009-2011, Mozilla Foundation and contributors, BSD</p>


  </div>
</div>
<div class="tags">
  

</div>
  <h2>Constant Summary</h2>
  <dl class="constants">
    
      <dt id="VLQ_BASE_SHIFT-constant" class="">VLQ_BASE_SHIFT =
        <div class="docstring">
  <div class="discussion">
    <p>A single base 64 digit can contain 6 bits of data. For the base 64 variable
length quantities we use in the source map spec, the first bit is the sign,
the next four bits are the actual value, and the 6th bit is the
continuation bit. The continuation bit tells us whether there are more
digits in this value following this digit.</p>

<p>Continuation
  |    Sign
  |    |
  V    V
  101011</p>


  </div>
</div>
<div class="tags">
  

</div>
      </dt>
      <dd><pre class="code"><span class='int'>5</span></pre></dd>
    
      <dt id="VLQ_BASE-constant" class="">VLQ_BASE =
        <div class="docstring">
  <div class="discussion">
    <p>binary: 100000</p>


  </div>
</div>
<div class="tags">
  

</div>
      </dt>
      <dd><pre class="code"><span class='int'>1</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="#VLQ_BASE_SHIFT-constant" title="SourceMap::VLQ::VLQ_BASE_SHIFT (constant)">VLQ_BASE_SHIFT</a></span></span></pre></dd>
    
      <dt id="VLQ_BASE_MASK-constant" class="">VLQ_BASE_MASK =
        <div class="docstring">
  <div class="discussion">
    <p>binary: 011111</p>


  </div>
</div>
<div class="tags">
  

</div>
      </dt>
      <dd><pre class="code"><span class='const'><span class='object_link'><a href="#VLQ_BASE-constant" title="SourceMap::VLQ::VLQ_BASE (constant)">VLQ_BASE</a></span></span> <span class='op'>-</span> <span class='int'>1</span></pre></dd>
    
      <dt id="VLQ_CONTINUATION_BIT-constant" class="">VLQ_CONTINUATION_BIT =
        <div class="docstring">
  <div class="discussion">
    <p>binary: 100000</p>


  </div>
</div>
<div class="tags">
  

</div>
      </dt>
      <dd><pre class="code"><span class='const'><span class='object_link'><a href="#VLQ_BASE-constant" title="SourceMap::VLQ::VLQ_BASE (constant)">VLQ_BASE</a></span></span></pre></dd>
    
      <dt id="BASE64_DIGITS-constant" class="">BASE64_DIGITS =
        
      </dt>
      <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</span><span class='tstring_end'>&#39;</span></span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></pre></dd>
    
      <dt id="BASE64_VALUES-constant" class="">BASE64_VALUES =
        
      </dt>
      <dd><pre class="code"><span class='lparen'>(</span><span class='int'>0</span><span class='op'>..</span><span class='int'>64</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span> <span class='const'><span class='object_link'><a href="#BASE64_DIGITS-constant" title="SourceMap::VLQ::BASE64_DIGITS (constant)">BASE64_DIGITS</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_i'>i</span> <span class='rbrace'>}</span></pre></dd>
    
  </dl>







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#decode-class_method" title="decode (class method)">.<strong>decode</strong>(str)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Decodes the next base 64 VLQ value from the given string and returns the value and the rest of the string.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#decode_array-class_method" title="decode_array (class method)">.<strong>decode_array</strong>(str)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Decode an array of variable length quantities from the given string and return them.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#encode-class_method" title="encode (class method)">.<strong>encode</strong>(int)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns the base 64 VLQ encoded value.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="decode-class_method">
  
    .<strong>decode</strong>(str)  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Decodes the next base 64 VLQ value from the given string and returns the
value and the rest of the string.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'opal/stdlib/source_map/vlq.rb', line 56</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_decode'>decode</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_vlq'>vlq</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_shift'>shift</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_continue'>continue</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='id identifier rubyid_chars'>chars</span> <span class='op'>=</span> <span class='id identifier rubyid_str'>str</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='kw'>while</span> <span class='id identifier rubyid_continue'>continue</span>
    <span class='id identifier rubyid_char'>char</span> <span class='op'>=</span> <span class='id identifier rubyid_chars'>chars</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span> <span class='kw'>or</span> <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Expected more digits in base 64 VLQ value.</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_digit'>digit</span> <span class='op'>=</span> <span class='id identifier rubyid_base64_decode'>base64_decode</span><span class='lparen'>(</span><span class='id identifier rubyid_char'>char</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_continue'>continue</span> <span class='op'>=</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_digit'>digit</span> <span class='op'>&amp;</span> <span class='const'><span class='object_link'><a href="#VLQ_CONTINUATION_BIT-constant" title="SourceMap::VLQ::VLQ_CONTINUATION_BIT (constant)">VLQ_CONTINUATION_BIT</a></span></span><span class='rparen'>)</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='id identifier rubyid_digit'>digit</span> <span class='op'>&amp;=</span> <span class='const'><span class='object_link'><a href="#VLQ_BASE_MASK-constant" title="SourceMap::VLQ::VLQ_BASE_MASK (constant)">VLQ_BASE_MASK</a></span></span>
    <span class='id identifier rubyid_vlq'>vlq</span> <span class='op'>+=</span> <span class='id identifier rubyid_digit'>digit</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_shift'>shift</span>
    <span class='id identifier rubyid_shift'>shift</span> <span class='op'>+=</span> <span class='const'><span class='object_link'><a href="#VLQ_BASE_SHIFT-constant" title="SourceMap::VLQ::VLQ_BASE_SHIFT (constant)">VLQ_BASE_SHIFT</a></span></span>
  <span class='kw'>end</span>

  <span class='lbracket'>[</span><span class='id identifier rubyid_from_vlq_signed'>from_vlq_signed</span><span class='lparen'>(</span><span class='id identifier rubyid_vlq'>vlq</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_chars'>chars</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="decode_array-class_method">
  
    .<strong>decode_array</strong>(str)  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Decode an array of variable length quantities from the given string and
return them.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


77
78
79
80
81
82
83
84</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'opal/stdlib/source_map/vlq.rb', line 77</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_decode_array'>decode_array</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>while</span> <span class='id identifier rubyid_str'>str</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_int'>int</span><span class='comma'>,</span> <span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_output'>output</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_int'>int</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_output'>output</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="encode-class_method">
  
    .<strong>encode</strong>(int)  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns the base 64 VLQ encoded value.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'opal/stdlib/source_map/vlq.rb', line 39</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_encode'>encode</span><span class='lparen'>(</span><span class='id identifier rubyid_int'>int</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_vlq'>vlq</span> <span class='op'>=</span> <span class='id identifier rubyid_to_vlq_signed'>to_vlq_signed</span><span class='lparen'>(</span><span class='id identifier rubyid_int'>int</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_encoded'>encoded</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='kw'>begin</span>
    <span class='id identifier rubyid_digit'>digit</span> <span class='op'>=</span> <span class='id identifier rubyid_vlq'>vlq</span> <span class='op'>&amp;</span> <span class='const'><span class='object_link'><a href="#VLQ_BASE_MASK-constant" title="SourceMap::VLQ::VLQ_BASE_MASK (constant)">VLQ_BASE_MASK</a></span></span>
    <span class='id identifier rubyid_vlq'>vlq</span> <span class='op'>&gt;&gt;=</span> <span class='const'><span class='object_link'><a href="#VLQ_BASE_SHIFT-constant" title="SourceMap::VLQ::VLQ_BASE_SHIFT (constant)">VLQ_BASE_SHIFT</a></span></span>
    <span class='id identifier rubyid_digit'>digit</span> <span class='op'>|=</span> <span class='const'><span class='object_link'><a href="#VLQ_CONTINUATION_BIT-constant" title="SourceMap::VLQ::VLQ_CONTINUATION_BIT (constant)">VLQ_CONTINUATION_BIT</a></span></span> <span class='kw'>if</span> <span class='id identifier rubyid_vlq'>vlq</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_encoded'>encoded</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_base64_encode'>base64_encode</span><span class='lparen'>(</span><span class='id identifier rubyid_digit'>digit</span><span class='rparen'>)</span>
  <span class='kw'>end</span> <span class='kw'>while</span> <span class='id identifier rubyid_vlq'>vlq</span> <span class='op'>&gt;</span> <span class='int'>0</span>

  <span class='id identifier rubyid_encoded'>encoded</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on 03/13/18 by
  <!-- <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a> -->
  0.9.9 (ruby-2.5.0).
</div>

    </div>
  </body>
</html>