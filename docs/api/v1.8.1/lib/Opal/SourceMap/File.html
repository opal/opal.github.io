<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Opal::SourceMap::File
  
    &mdash; lib (Opal v1.8.1)
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Opal::SourceMap::File";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  <span class="title"><a href="/docs">Opal Docs</a></span>
  
    &raquo;
    <a href="../../_index.html">Index (F)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Opal.html" title="Opal (module)">Opal</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../SourceMap.html" title="Opal::SourceMap (module)">SourceMap</a></span></span>
     &raquo; 
    <span class="title">File</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Opal::SourceMap::File
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Opal::SourceMap::File</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="Map.html" title="Opal::SourceMap::Map (module)">Map</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>opal/lib/opal/source_map/file.rb</dd>
  </dl>
  
</div>





  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#file-instance_method" title="#file (instance method)">#<strong>file</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns the value of attribute file.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#fragments-instance_method" title="#fragments (instance method)">#<strong>fragments</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns the value of attribute fragments.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#source-instance_method" title="#source (instance method)">#<strong>source</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns the value of attribute source.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#absolute_mappings-instance_method" title="#absolute_mappings (instance method)">#<strong>absolute_mappings</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The “mappings” data is broken down as follows:.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generated_code-instance_method" title="#generated_code (instance method)">#<strong>generated_code</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(fragments, file, source, generated_code = nil)  &#x21d2; File </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A new instance of File.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#map-instance_method" title="#map (instance method)">#<strong>map</strong>(source_root: &#39;&#39;)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Proposed Format 1: { 2: &quot;version&quot; : 3, 3: &quot;file&quot;: &quot;out.js&quot;, 4: &quot;sourceRoot&quot;: &quot;&quot;, 5: &quot;sources&quot;: [&quot;foo.js&quot;, &quot;bar.js&quot;], 6: &quot;sourcesContent&quot;: [null, null], 7: &quot;names&quot;: [&quot;src&quot;, &quot;maps&quot;, &quot;are&quot;, &quot;fun&quot;], 8: &quot;mappings&quot;: &quot;A,AAAB;;ABCDE;&quot; 9: }.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#names-instance_method" title="#names (instance method)">#<strong>names</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#relative_mappings-instance_method" title="#relative_mappings (instance method)">#<strong>relative_mappings</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#segment_from_fragment-instance_method" title="#segment_from_fragment (instance method)">#<strong>segment_from_fragment</strong>(fragment, generated_column)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The fields in each segment are:.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Map.html" title="Opal::SourceMap::Map (module)">Map</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Map.html#as_json-instance_method" title="Opal::SourceMap::Map#as_json (method)">#as_json</a></span>, <span class='object_link'><a href="Map.html#cache-instance_method" title="Opal::SourceMap::Map#cache (method)">#cache</a></span>, <span class='object_link'><a href="Map.html#marshal_dump-instance_method" title="Opal::SourceMap::Map#marshal_dump (method)">#marshal_dump</a></span>, <span class='object_link'><a href="Map.html#marshal_load-instance_method" title="Opal::SourceMap::Map#marshal_load (method)">#marshal_load</a></span>, <span class='object_link'><a href="Map.html#to_data_uri_comment-instance_method" title="Opal::SourceMap::Map#to_data_uri_comment (method)">#to_data_uri_comment</a></span>, <span class='object_link'><a href="Map.html#to_h-instance_method" title="Opal::SourceMap::Map#to_h (method)">#to_h</a></span>, <span class='object_link'><a href="Map.html#to_json-instance_method" title="Opal::SourceMap::Map#to_json (method)">#to_json</a></span>, <span class='object_link'><a href="Map.html#to_s-instance_method" title="Opal::SourceMap::Map#to_s (method)">#to_s</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(fragments, file, source, generated_code = nil)  &#x21d2; <tt><span class='object_link'><a href="" title="Opal::SourceMap::File (class)">File</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns a new instance of File.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


10
11
12
13
14
15
16
17</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'opal/lib/opal/source_map/file.rb', line 10</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_fragments'>fragments</span><span class='comma'>,</span> <span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='id identifier rubyid_generated_code'>generated_code</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='ivar'>@fragments</span> <span class='op'>=</span> <span class='id identifier rubyid_fragments'>fragments</span>
  <span class='ivar'>@file</span> <span class='op'>=</span> <span class='id identifier rubyid_file'>file</span>
  <span class='ivar'>@source</span> <span class='op'>=</span> <span class='id identifier rubyid_source'>source</span>
  <span class='ivar'>@names_map</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_hash'>hash</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='op'>|</span> <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='rbrace'>}</span>
  <span class='ivar'>@generated_code</span> <span class='op'>=</span> <span class='id identifier rubyid_generated_code'>generated_code</span>
  <span class='ivar'>@absolute_mappings</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="file-instance_method">
  
    #<strong>file</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns the value of attribute file.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


7
8
9</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'opal/lib/opal/source_map/file.rb', line 7</span>

<span class='kw'>def</span> <span class='id identifier rubyid_file'>file</span>
  <span class='ivar'>@file</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="fragments-instance_method">
  
    #<strong>fragments</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns the value of attribute fragments.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


6
7
8</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'opal/lib/opal/source_map/file.rb', line 6</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fragments'>fragments</span>
  <span class='ivar'>@fragments</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="source-instance_method">
  
    #<strong>source</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns the value of attribute source.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


8
9
10</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'opal/lib/opal/source_map/file.rb', line 8</span>

<span class='kw'>def</span> <span class='id identifier rubyid_source'>source</span>
  <span class='ivar'>@source</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="absolute_mappings-instance_method">
  
    #<strong>absolute_mappings</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The “mappings” data is broken down as follows:</p>

<p>each group representing a line in the generated file is separated by a ”;”
each segment is separated by a “,”
each segment is made up of 1,4 or 5 variable length fields.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'opal/lib/opal/source_map/file.rb', line 160</span>

<span class='kw'>def</span> <span class='id identifier rubyid_absolute_mappings'>absolute_mappings</span>
  <span class='ivar'>@absolute_mappings</span> <span class='op'>||=</span> <span class='kw'>begin</span>
    <span class='id identifier rubyid_mappings'>mappings</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_fragments_by_line'>fragments_by_line</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_raw_segments'>raw_segments</span><span class='op'>|</span>
      <span class='id identifier rubyid_generated_column'>generated_column</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_segments'>segments</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_raw_segments'>raw_segments</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='lparen'>(</span><span class='id identifier rubyid_generated_code'>generated_code</span><span class='comma'>,</span> <span class='id identifier rubyid_fragment'>fragment</span><span class='rparen'>)</span><span class='op'>|</span>
        <span class='kw'>unless</span> <span class='id identifier rubyid_fragment'>fragment</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Opal.html" title="Opal (module)">Opal</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Fragment.html" title="Opal::Fragment (class)">Fragment</a></span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_fragment'>fragment</span><span class='period'>.</span><span class='id identifier rubyid_skip_source_map?'>skip_source_map?</span>
          <span class='id identifier rubyid_segments'>segments</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_segment_from_fragment'>segment_from_fragment</span><span class='lparen'>(</span><span class='id identifier rubyid_fragment'>fragment</span><span class='comma'>,</span> <span class='id identifier rubyid_generated_column'>generated_column</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_generated_column'>generated_column</span> <span class='op'>+=</span> <span class='id identifier rubyid_generated_code'>generated_code</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_mappings'>mappings</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_segments'>segments</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_mappings'>mappings</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="generated_code-instance_method">
  
    #<strong>generated_code</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


19
20
21</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'opal/lib/opal/source_map/file.rb', line 19</span>

<span class='kw'>def</span> <span class='id identifier rubyid_generated_code'>generated_code</span>
  <span class='ivar'>@generated_code</span> <span class='op'>||=</span> <span class='ivar'>@fragments</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:code</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="map-instance_method">
  
    #<strong>map</strong>(source_root: &#39;&#39;)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Proposed Format
1: {
2: &quot;version&quot; : 3,
3: &quot;file&quot;: &quot;out.js&quot;,
4: &quot;sourceRoot&quot;: &quot;&quot;,
5: &quot;sources&quot;: [&quot;foo.js&quot;, &quot;bar.js&quot;],
6: &quot;sourcesContent&quot;: [null, null],
7: &quot;names&quot;: [&quot;src&quot;, &quot;maps&quot;, &quot;are&quot;, &quot;fun&quot;],
8: &quot;mappings&quot;: &quot;A,AAAB;;ABCDE;&quot;
9: }</p>

<p>Line 1: The entire file is a single JSON object
Line 2: File version (always the first entry in the object) and must be a
        positive integer.
Line 3: An optional name of the generated code that this source map is
        associated with.
Line 4: An optional source root, useful for relocating source files on a server
        or removing repeated values in the “sources” entry. This value is prepended to
        the individual entries in the “source” field.
Line 5: A list of original sources used by the “mappings” entry.
Line 6: An optional list of source content, useful when the “source” can’t be
        hosted. The contents are listed in the same order as the sources in line 5.
        “null” may be used if some original sources should be retrieved by name.
Line 7: A list of symbol names used by the “mappings” entry.
Line 8: A string with the encoded mapping data.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


48
49
50
51
52
53
54
55
56
57
58
59
60</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'opal/lib/opal/source_map/file.rb', line 48</span>

<span class='kw'>def</span> <span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='label'>source_root:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='lbrace'>{</span>
    <span class='label'>version:</span> <span class='int'>3</span><span class='comma'>,</span>
    <span class='comment'># file: &quot;out.js&quot;, # This is optional
</span>    <span class='label'>sourceRoot:</span> <span class='id identifier rubyid_source_root'>source_root</span><span class='comma'>,</span>
    <span class='label'>sources:</span> <span class='lbracket'>[</span><span class='id identifier rubyid_file'>file</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='label'>sourcesContent:</span> <span class='lbracket'>[</span><span class='id identifier rubyid_source'>source</span><span class='period'>.</span><span class='id identifier rubyid_encoding'>encoding</span> <span class='op'>==</span> <span class='const'>Encoding</span><span class='op'>::</span><span class='const'>UTF_8</span> <span class='op'>?</span> <span class='id identifier rubyid_source'>source</span> <span class='op'>:</span> <span class='id identifier rubyid_source'>source</span><span class='period'>.</span><span class='id identifier rubyid_encode'>encode</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>UTF-8</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>undef:</span> <span class='symbol'>:replace</span><span class='rparen'>)</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='label'>names:</span> <span class='id identifier rubyid_names'>names</span><span class='comma'>,</span>
    <span class='label'>mappings:</span> <span class='const'><span class='object_link'><a href="../../Opal.html" title="Opal (module)">Opal</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../SourceMap.html" title="Opal::SourceMap (module)">SourceMap</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="VLQ.html" title="Opal::SourceMap::VLQ (module)">VLQ</a></span></span><span class='period'>.</span><span class='id identifier rubyid_encode_mappings'><span class='object_link'><a href="VLQ.html#encode_mappings-class_method" title="Opal::SourceMap::VLQ.encode_mappings (method)">encode_mappings</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_relative_mappings'>relative_mappings</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='comment'># x_com_opalrb_original_lines: source.count(&quot;\n&quot;),
</span>    <span class='comment'># x_com_opalrb_generated_lines: generated_code.count(&quot;\n&quot;),
</span>  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="names-instance_method">
  
    #<strong>names</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64
65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'opal/lib/opal/source_map/file.rb', line 62</span>

<span class='kw'>def</span> <span class='id identifier rubyid_names'>names</span>
  <span class='ivar'>@names</span> <span class='op'>||=</span> <span class='kw'>begin</span>
    <span class='id identifier rubyid_absolute_mappings'>absolute_mappings</span> <span class='comment'># let the processing happen
</span>    <span class='ivar'>@names_map</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_index'>index</span><span class='op'>|</span> <span class='id identifier rubyid_index'>index</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='op'>|</span> <span class='id identifier rubyid_name'>name</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="relative_mappings-instance_method">
  
    #<strong>relative_mappings</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'opal/lib/opal/source_map/file.rb', line 126</span>

<span class='kw'>def</span> <span class='id identifier rubyid_relative_mappings'>relative_mappings</span>
  <span class='ivar'>@relative_mappings</span> <span class='op'>||=</span> <span class='kw'>begin</span>
    <span class='id identifier rubyid_reference_segment'>reference_segment</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_reference_name_index'>reference_name_index</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_absolute_mappings'>absolute_mappings</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_absolute_mapping'>absolute_mapping</span><span class='op'>|</span>
      <span class='comment'># [generated_column, source_index, original_line, original_column, map_name_index]
</span>      <span class='id identifier rubyid_reference_segment'>reference_segment</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0</span> <span class='comment'># reset the generated_column at each new line
</span>
      <span class='id identifier rubyid_absolute_mapping'>absolute_mapping</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_absolute_segment'>absolute_segment</span><span class='op'>|</span>
        <span class='id identifier rubyid_segment'>segment</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

        <span class='id identifier rubyid_segment'>segment</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_absolute_segment'>absolute_segment</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>-</span> <span class='id identifier rubyid_reference_segment'>reference_segment</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_segment'>segment</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_absolute_segment'>absolute_segment</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>-</span> <span class='lparen'>(</span><span class='id identifier rubyid_reference_segment'>reference_segment</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_segment'>segment</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_absolute_segment'>absolute_segment</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span> <span class='op'>-</span> <span class='lparen'>(</span><span class='id identifier rubyid_reference_segment'>reference_segment</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_segment'>segment</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_absolute_segment'>absolute_segment</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span> <span class='op'>-</span> <span class='lparen'>(</span><span class='id identifier rubyid_reference_segment'>reference_segment</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span><span class='rparen'>)</span>

        <span class='comment'># Since [4] can be nil we need to keep track of it in the reference_segment even if it&#39;s nil in absolute_segment
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_absolute_segment'>absolute_segment</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_segment'>segment</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_absolute_segment'>absolute_segment</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_int'>to_int</span> <span class='op'>-</span> <span class='lparen'>(</span><span class='id identifier rubyid_reference_segment'>reference_segment</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_reference_name_index'>reference_name_index</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_int'>to_int</span>
          <span class='id identifier rubyid_reference_name_index'>reference_name_index</span> <span class='op'>=</span> <span class='id identifier rubyid_absolute_segment'>absolute_segment</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span>
        <span class='kw'>end</span>

        <span class='id identifier rubyid_reference_segment'>reference_segment</span> <span class='op'>=</span> <span class='id identifier rubyid_absolute_segment'>absolute_segment</span>
        <span class='id identifier rubyid_segment'>segment</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="segment_from_fragment-instance_method">
  
    #<strong>segment_from_fragment</strong>(fragment, generated_column)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The fields in each segment are:</p>

<ol>
<li><p>The zero-based starting column of the line in the generated code that
the segment represents. If this is the first field of the first segment, or
the first segment following a new generated line (“;”), then this field
holds the whole base 64 VLQ. Otherwise, this field contains a base 64 VLQ
that is relative to the previous occurrence of this field. Note that this
is different than the fields below because the previous value is reset
after every generated line.</p></li>
<li><p>If present, an zero-based index into the “sources” list. This field is
a base 64 VLQ relative to the previous occurrence of this field, unless
this is the first occurrence of this field, in which case the whole value
is represented.</p></li>
<li><p>If present, the zero-based starting line in the original source
represented. This field is a base 64 VLQ relative to the previous
occurrence of this field, unless this is the first occurrence of this
field, in which case the whole value is represented. Always present if
there is a source field.</p></li>
<li><p>If present, the zero-based starting column of the line in the source
represented. This field is a base 64 VLQ relative to the previous
occurrence of this field, unless this is the first occurrence of this
field, in which case the whole value is represented. Always present if
there is a source field.</p></li>
<li><p>If present, the zero-based index into the “names” list associated with
this segment. This field is a base 64 VLQ relative to the previous
occurrence of this field, unless this is the first occurrence of this
field, in which case the whole value is represented.</p></li>
</ol>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'opal/lib/opal/source_map/file.rb', line 100</span>

<span class='kw'>def</span> <span class='id identifier rubyid_segment_from_fragment'>segment_from_fragment</span><span class='lparen'>(</span><span class='id identifier rubyid_fragment'>fragment</span><span class='comma'>,</span> <span class='id identifier rubyid_generated_column'>generated_column</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_source_index'>source_index</span>     <span class='op'>=</span> <span class='int'>0</span>                          <span class='comment'># always 0, we&#39;re dealing with a single file
</span>  <span class='id identifier rubyid_original_line'>original_line</span>    <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_fragment'>fragment</span><span class='period'>.</span><span class='id identifier rubyid_line'>line</span> <span class='op'>||</span> <span class='int'>0</span><span class='rparen'>)</span> <span class='op'>-</span> <span class='int'>1</span>   <span class='comment'># fragments have 1-based lines
</span>  <span class='id identifier rubyid_original_line'>original_line</span>    <span class='op'>=</span> <span class='int'>0</span> <span class='kw'>if</span> <span class='id identifier rubyid_original_line'>original_line</span> <span class='op'>&lt;</span> <span class='int'>0</span>     <span class='comment'># line 0 (-1) for fragments in source maps will crash
</span>                                                <span class='comment'># browsers devtools and the webpack build process
</span>  <span class='id identifier rubyid_original_column'>original_column</span>  <span class='op'>=</span> <span class='id identifier rubyid_fragment'>fragment</span><span class='period'>.</span><span class='id identifier rubyid_column'>column</span> <span class='op'>||</span> <span class='int'>0</span>       <span class='comment'># fragments have 0-based columns
</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_fragment'>fragment</span><span class='period'>.</span><span class='id identifier rubyid_source_map_name'>source_map_name</span>
    <span class='id identifier rubyid_map_name_index'>map_name_index</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='ivar'>@names_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_fragment'>fragment</span><span class='period'>.</span><span class='id identifier rubyid_source_map_name'>source_map_name</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='ivar'>@names_map</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>
    <span class='lbracket'>[</span>
      <span class='id identifier rubyid_generated_column'>generated_column</span><span class='comma'>,</span>
      <span class='id identifier rubyid_source_index'>source_index</span><span class='comma'>,</span>
      <span class='id identifier rubyid_original_line'>original_line</span><span class='comma'>,</span>
      <span class='id identifier rubyid_original_column'>original_column</span><span class='comma'>,</span>
      <span class='id identifier rubyid_map_name_index'>map_name_index</span><span class='comma'>,</span>
    <span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='lbracket'>[</span>
      <span class='id identifier rubyid_generated_column'>generated_column</span><span class='comma'>,</span>
      <span class='id identifier rubyid_source_index'>source_index</span><span class='comma'>,</span>
      <span class='id identifier rubyid_original_line'>original_line</span><span class='comma'>,</span>
      <span class='id identifier rubyid_original_column'>original_column</span><span class='comma'>,</span>
    <span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on 11/09/23 by
  <!-- <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a> -->
  0.9.34 (ruby-2.7.5).
</div>

    </div>
  </body>
</html>