<!doctype html>
<html style="background-color: #f5f5f5; min-height: 100%;">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <title>Opal Blog</title>

  <link href="/assets/application-915b7e3cafe6e192dee011fa09837b2af85b7e1de3dbb52fd1413d46dd2dca0e.css" rel="stylesheet" />
  <link href="//code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" rel="stylesheet" />

  <script src="/assets/application-74994a7410818947c294a5f44b8f7916d5e1c773e93a5a2c83db9c06d516fd80.js" onload="Opal.loaded(typeof(OpalLoaded) === &quot;undefined&quot; ? [] : OpalLoaded);
Opal.require(&quot;application&quot;);;console.log('loaded application')"></script>

  <!-- Algolia -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
</head>
<body class="blog blog_index">
  <nav class='navbar navbar-default opal-nav' role='navigation'>
<div class='container'>
<div class='navbar-header'>
<a class='navbar-brand' href='/'>
<img height='22' src='https://secure.gravatar.com/avatar/88298620949a6534d403da2e356c9339?s=420&amp;d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png' style='margin-top:-10%;' width='22'>
Opal
</a>
<button class='navbar-toggle' data-target='#opal-navbar' data-toggle='collapse' type='button'>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
</button>
</div>
<div class='navbar-collapse collapse' id='opal-navbar'>
<ul class='nav navbar-nav'>
<li>
<a href='/try'>
<i class='ion-ios-compose'></i>
Try
</a>
</li>
<li>
<a href='/blog'>
<i class='ion-ios-chatboxes'></i>
Blog
</a>
</li>
<li>
<a href='/docs'>
<i class='ion-ios-copy'></i>
Documentation
</a>
</li>
<li>
<a href='/libraries'>
<i class='ion-map'></i>
Libraries
</a>
</li>
<li>
<a href='https://github.com/opal/opal#readme'>
<i class='ion-social-github'></i>
GitHub
</a>
</li>
<li>
<a href='https://rubygems.org/gems/opal/versions/1.8.1' style='opacity: 0.5;'>
v1.8.1
</a>
</li>
</ul>
<ul class='nav navbar-right'>
<li class='search-bar'>
<form id='search-form'>
<input placeholder='Search docs &amp; guides' type='search'>
<button title='Clear the search query.' type='reset'>
&times;
</button>
</form>
</li>
</ul>
</div>
</div>
</nav>


  <div class="container">
    <div class='container col-sm-8'>
<div class='blog-posts'>
<div class='blog-title'>
<h1>
<a href='/blog'>The Opal Blog</a>
</h1>
</div>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2023/03/30/opal-won-fukuoka-ruby-award-for-outstanding-performance/'>
Opal Won the Fukuoka Ruby Award 2023 for Outstanding Performance
</a>
</h2>
<div class='blog-post-meta'>
Posted by elia, hmdne
<br>
March 30, 2023
</div>
</header>
<div class='blog-post-body'>
<p>Opal has recently won the prestigious <a href="https://www.digitalfukuoka.jp/topics/228?locale=ja">Fukuoka Ruby Award for Outstanding Performance in the 2023 edition</a>. This is a major achievement for the project and its developers, and it reflects the significant contributions that Opal has made to the Ruby programming language and its ecosystem.</p>&#x000A;&#x000A;<p>Opal is an open-source project that allows developers to write Ruby code and run it in the browser. It achieves this by compiling Ruby code into JavaScript, which can then be executed in a browser environment. This approach has many advantages, including the ability to reuse existing Ruby code and the ability to write web applications entirely in Ruby, without needing to use JavaScript at all.</p>&#x000A;&#x000A;<p>Opal has been around since 2011, and it has steadily gained popularity over the years. It is now widely used by Ruby developers who want to use Ruby on both the front-end and the back-end of their applications or who want to port their Ruby libraries to JavaScript.</p>&#x000A;&#x000A;<a href="/blog/2023/03/30/opal-won-fukuoka-ruby-award-for-outstanding-performance/#continue-reading">continue reading…</a></div>
</article>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2023/01/06/opal-1-7-ruby-3-2/'>
Opal 1.7, Ruby 3.2, --watch
</a>
</h2>
<div class='blog-post-meta'>
Posted by elia
<br>
January 06, 2023
</div>
</header>
<div class='blog-post-body'>
<p>We&#39;re excited to announce the release of Opal v1.7! This release includes support for Ruby 3.2 and the ability to watch file changes with the <code>--watch</code> flag.</p>&#x000A;&#x000A;<h2 id="ruby-3-2-support">Ruby 3.2 Support</h2>&#x000A;&#x000A;<p>Opal v1.7 adds support for Ruby 3.2, the latest version of the Ruby programming language. This means that you can use most of the new features and improvements in Ruby 3.2 when writing your Opal code.</p>&#x000A;&#x000A;<h2 id="watching-file-changes-with-the-watch-flag">Watching File Changes with the <code>--watch</code> Flag</h2>&#x000A;&#x000A;<p>Opal v1.7 introduces the <code>--watch</code> flag, which allows you to automatically recompile your code whenever a file is changed. This is especially useful when working on larger projects, as it saves you the time and effort of manually recompiling your code every time you make a change.</p>&#x000A;&#x000A;<p>To use the <code>--watch</code> flag, simply pass it as an argument when running the <code>opal</code> command. For example:</p>&#x000A;<div class="highlight"><pre class="highlight shell"><code>opal <span class="nt">--output</span><span class="o">=</span>main.js <span class="nt">--watch</span> main.rb&#x000A;</code></pre></div>&#x000A;<p>This will start the Opal compiler and watch for any changes to the <code>main.rb</code> file. When a change is detected, the compiler will automatically recompile the code.</p>&#x000A;&#x000A;<p>We hope these new features will make it easier for you to write and debug your Opal code. As always, please report any issues or feedback on the Opal GitHub repository.</p>&#x000A;&#x000A;<p><em>If you work on macOS be sure to install v1.7.1 that includes a fix for reading the most updated content of watched files.</em></p>&#x000A;&#x000A;<h2 id="new-runners">New runners</h2>&#x000A;&#x000A;<p>Support was added for running code in Deno, Firefox, and Safari, if any of those is available on your box you can try them out by passing <code>--runner</code> with <code>safari</code>, <code>firefox</code>, or <code>deno</code>.</p>&#x000A;&#x000A;<p>Example:</p>&#x000A;<div class="highlight"><pre class="highlight shell"><code><span class="nv">$ </span><span class="c"># Remember to enable "Allow Remote Automation" in Safari's Develop menu</span>&#x000A;<span class="nv">$ </span>opal:master ⤑ bin/opal <span class="nt">--runner</span><span class="o">=</span>safari <span class="nt">-ropal</span>/platform <span class="nt">-e</span> <span class="s2">"puts 'Hello from Webkit, heir of Konqueror!'"</span>                                                     ~/C/opal&#x000A;Connecting to localhost:9444...&#x000A;Connecting to localhost:9444...&#x000A;Connecting to localhost:9444...&#x000A;Hello from Webkit, heir of Konqueror!&#x000A;</code></pre></div>&#x000A;<hr>&#x000A;&#x000A;<h3 id="resources">Resources</h3>&#x000A;&#x000A;<ul>&#x000A;<li><a href="https://github.com/opal/opal/releases/tag/v1.7.0">Changelog for v1.7.0</a></li>&#x000A;<li><a href="https://github.com/opal/opal/compare/v1.6.1...v1.7.0">List of commits</a> / <a href="https://github.com/opal/opal/compare/v1.6.1...v1.7.0.diff">raw diff</a></li>&#x000A;<li><a href="https://opalrb.com">Updated website</a></li>&#x000A;<li><a href="http://opalrb.com/docs/">Documentation</a></li>&#x000A;</ul>&#x000A;</div>
</article>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2022/11/24/opal-1-6-opal-rspec-1-0/'>
Opal 1.6 and Opal-RSpec 1.0
</a>
</h2>
<div class='blog-post-meta'>
Posted by hmdne, elia, janbiedermann
<br>
November 24, 2022
</div>
</header>
<div class='blog-post-body'>
<p>We are happy to announce that Opal 1.6 and Opal-RSpec 1.0 are out!</p>&#x000A;&#x000A;<p>Opal is a Ruby (3.1) to JavaScript (ES5) compiler allowing you to write frontend code in pure Ruby and have it translated to clean and efficient JavaScript. It also includes a highly compatible core library that includes all the methods you&#39;ve come to love. All this with a robust support of source maps, so you can debug Ruby code, not JavaScript in your Web Console. It can be used both to create websites entirely in Ruby (using <a href="https://github.com/opal/opal-browser">Opal-Browser</a>, or <a href="https://opalrb.com/libraries/">ports of known JavaScript libraries</a>) and to port existing Ruby libraries to JavaScript, to be ran both in Node.JS and in web browsers (and other JavaScript environments).</p>&#x000A;&#x000A;<p>Opal-RSpec is an Opal port of <a href="https://rspec.info/">RSpec</a>, a well known Ruby testing tool, allowing you to easily test your Ruby applications in browser and in Node, just like you can do so with MRI.</p>&#x000A;&#x000A;<p>This release of Opal is focused primarily on improving upon MRI compatibility. We now fully support freezing and also we now have a new robust and hackable control flow instruction handling implementation (think: <code>break</code>, <code>next</code>, <code>return</code>...). Also, Windows support has been improved and Opal gained a parallel compile support - significantly improving compile times on multicore systems. In addition, the <code>await</code> subsystem is no longer experimental.</p>&#x000A;&#x000A;<p>Try it now on <a href="https://opalrb.com/try">opalrb.com/try</a>, or get started instantly with no further steps required (except for installing Ruby):</p>&#x000A;<div class="highlight"><pre class="highlight plaintext"><code>gem install opal&#x000A;# Try either of the following examples:&#x000A;opal -e 'puts "Hello world!"'&#x000A;opal -ce 'puts "Hello world!"' &gt; hello_world.js; node hello_world.js&#x000A;opal -OcEe 'puts "Hello world!"'&#x000A;# Or run it in a web browser:&#x000A;bundle init&#x000A;bundle add opal-browser puma&#x000A;bundle add rack -v '&lt; 3'&#x000A;bundle exec opal -Rserver -qopal-browser -rbrowser -e '$document.write("Hello world!")'&#x000A;</code></pre></div>&#x000A;<a href="/blog/2022/11/24/opal-1-6-opal-rspec-1-0/#continue-reading">continue reading…</a></div>
</article>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2022/04/13/opal-1-5/'>
Opal 1.5: binding.irb in a web browser
</a>
</h2>
<div class='blog-post-meta'>
Posted by hmdne, elia
<br>
April 13, 2022
</div>
</header>
<div class='blog-post-body'>
<p>We are happy to announce that Opal 1.5 is out!</p>&#x000A;&#x000A;<p>Opal is a Ruby (3.1) to JavaScript (ES5) compiler allowing you to write frontend code in pure Ruby and have it translated to clean and efficient JavaScript. It also includes a highly compatible core library that includes all the methods you&#39;ve come to love.</p>&#x000A;&#x000A;<p>This release is mostly focused on performance improvements. In fact, in our tests, we got a 2x performance bump for the Opal Ruby compiler running in V8! As always, we have some new features (<code>binding.irb</code>), some compatibility improvements and a bunch of bugfixes.</p>&#x000A;&#x000A;<p>Try it now on <a href="https://opalrb.com/try">opalrb.com/try</a>.</p>&#x000A;&#x000A;<a href="/blog/2022/04/13/opal-1-5/#continue-reading">continue reading…</a></div>
</article>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2021/12/24/opal-1-4/'>
Opal 1.4: Ruby 3.1, performance, and bundle size
</a>
</h2>
<div class='blog-post-meta'>
Posted by hmdne
<br>
December 24, 2021
</div>
</header>
<div class='blog-post-body'>
<p>We are proud to announce an immediate availability of Opal 1.4!</p>&#x000A;&#x000A;<p>Opal is a Ruby to JavaScript (ES5) compiler allowing you to write frontend code in pure Ruby (and a lot more!).</p>&#x000A;&#x000A;<p>This version of Opal is about compatibility with Ruby 3.1 and lots of internal improvement around performance, code size, and readability of the generated code. Opal 1.3 was released just about 2 months ago, but we really wanted to get 3.1-level compatibility out around the time Ruby 3.1 is released this Christmas.</p>&#x000A;&#x000A;<p><em>As always, you don&#39;t need to run Opal with Ruby 3.1 to benefit from the 3.1-level features, Ruby 2.6 will do just fine :)</em></p>&#x000A;&#x000A;<a href="/blog/2021/12/24/opal-1-4/#continue-reading">continue reading…</a></div>
</article>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2021/11/24/optimizing-opal-output-for-size/'>
Optimizing Opal output for size
</a>
</h2>
<div class='blog-post-meta'>
Posted by hmdne
<br>
November 24, 2021
</div>
</header>
<div class='blog-post-body'>
<p>Opal doesn&#39;t output the smallest code possible - that&#39;s not our goal. We want to output readable ES5 code and we have tools: JS minifiers&#x000A;(<a href="https://terser.org/">Terser</a> and <a href="https://developers.google.com/closure/compiler/">Google Closure Compiler</a>), and tree shaking utilities&#x000A;(<a href="https://github.com/hmdne/opal-optimizer">opal-optimizer</a>) to bring the code size down.</p>&#x000A;&#x000A;<p>JavaScript and Ruby certainly have some different semantics. Some things work similarly (like open classes), but some others don&#39;t - and those that don&#39;t&#x000A;require some boilerplate code. That not only reduces performance, but also increases load times, both crucial for JavaScript code.</p>&#x000A;&#x000A;<p>In this article we will particularly focus on Terser, since it&#39;s the most widely used tool for Opal post-processing. Can Terser find every nook and&#x000A;cranny and optimize the resulting code to the minimal JavaScript version possible? Unfortunately not. It doesn&#39;t have a knowledge about which&#x000A;statements can produce side effects and which don&#39;t. And so it only does the transformations that are semantically equivalent. But while compiling,&#x000A;we may know something more.</p>&#x000A;&#x000A;<a href="/blog/2021/11/24/optimizing-opal-output-for-size/#continue-reading">continue reading…</a></div>
</article>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2021/11/03/opal-1-3/'>
Opal 1.3
</a>
</h2>
<div class='blog-post-meta'>
Posted by hmdne
<br>
November 03, 2021
</div>
</header>
<div class='blog-post-body'>
<p>We have released Opal v1.3.0 a week ago and today we are releasing Opal v1.3.1 containing a few last minute fixes. We plan Opal v1.3 to be supported with a best-effort principle for a longer term, backporting bugfixes.</p>&#x000A;&#x000A;<p>This is quite a big release with a special focus on developer tools and error reporting improvements.</p>&#x000A;&#x000A;<a href="/blog/2021/11/03/opal-1-3/#continue-reading">continue reading…</a></div>
</article>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2021/08/09/opal-1-2/'>
Opal 1.2
</a>
</h2>
<div class='blog-post-meta'>
Posted by hmdne
<br>
August 09, 2021
</div>
</header>
<div class='blog-post-body'>
<p>After about 11 years of development we are proud to announce the Opal 1.2 release!</p>&#x000A;&#x000A;<p>Opal is a Ruby to JavaScript compiler, Ruby runtime and an idiomatic Ruby API for interfacing Browser/Node/<code>anything that uses JS</code>.</p>&#x000A;&#x000A;<h2 id="notable-new-features">Notable new features</h2>&#x000A;&#x000A;<h3 id="full-ruby-3-0-support-almost">Full Ruby 3.0 support! (almost)</h3>&#x000A;&#x000A;<p>We missed a blog post about Opal 1.1, which was released with a preliminary support for Ruby 3.0 features, but Opal 1.2 finalizes this support. Let me update you about them!</p>&#x000A;&#x000A;<p><em>An interesting thing is that you can still run older versions of Ruby on the backend, but use the new Ruby 3.0 features when writing Opal code for your frontend.</em></p>&#x000A;&#x000A;<a href="/blog/2021/08/09/opal-1-2/#continue-reading">continue reading…</a></div>
</article>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2021/06/26/webassembly-and-advanced-regexp-with-opal/'>
WebAssembly and advanced regular expressions with Opal
</a>
</h2>
<div class='blog-post-meta'>
Posted by Interscript
<br>
June 26, 2021
</div>
</header>
<div class='blog-post-body'>
<p><em>(This is a guest-post from the people at <a href="https://github.com/interscript/interscript">Interscript</a>, featuring an in-depth account of the work done around building a web-assebly bridge and compiling Onigmo for Opal)</em></p>&#x000A;&#x000A;<hr>&#x000A;&#x000A;<p>At <a href="https://github.com/riboseinc">Ribose Inc</a> we develop <a href="https://github.com/interscript/interscript">Interscript</a>, an open source Ruby implementation of interoperable transliteration schemes from ALA-LC, BGN/PCGN, ICAO, ISO, UN (by UNGEGN) and many, many other script conversion system authorities. The goal of this project is to achieve interoperable transliteration schemes allowing quality comparisons.</p>&#x000A;&#x000A;<p>We decided to port our software to JavaScript using Opal (the Ruby to JavaScript compiler), so it can be also used in web browsers and Node environments. The problem is - Opal translates Ruby regular expressions (upon which we rely quite heavily) to JavaScript almost verbatim. This made our ported codebase incompatible on principle, so we searched for a better solution.</p>&#x000A;&#x000A;<p>Unfortunately, Regexp is basically something like a programming language that has more than a dozen of incompatible implementations - even across the web browsers. For instance, we need lookbehind assertions, but even if there is a new standard in ECMAScript which adds lookbehind assertions, Safari doesn&#39;t implement that.</p>&#x000A;&#x000A;<p>Given all this context let&#39;s dive into how we ported the original Ruby Regexp engine to the browser!</p>&#x000A;&#x000A;<a href="/blog/2021/06/26/webassembly-and-advanced-regexp-with-opal/#continue-reading">continue reading…</a></div>
</article>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2019/05/12/opal-1-0/'>
Opal 1.0
</a>
</h2>
<div class='blog-post-meta'>
Posted by Elia Schito
<br>
May 12, 2019
</div>
</header>
<div class='blog-post-body'>
<p>Dear Opalists of the world,&#x000A;<br>the time has come, <strong>1.0 has been released</strong>!</p>&#x000A;&#x000A;<p>This is, of course, a really important milestone, one that I&#39;ve been waiting on for about seven years. I started advocating for releasing version 1.0 back in 2012 when Opal was still at version 0.3. After all, at that time I already had code in production, and according to <a href="https://semver.org">Semver</a> (which by then was still a new thing) that&#39;s one of the criteria for releasing 1.0:</p>&#x000A;&#x000A;<blockquote>&#x000A;<p>How do I know when to release 1.0.0?</p>&#x000A;&#x000A;<p>If your software is being used in production, it should probably already be 1.0.0. If you have a stable API on which users have come to depend, you should be 1.0.0. If you’re worrying a lot about backward compatibility, you should probably already be 1.0.0.</p>&#x000A;</blockquote>&#x000A;&#x000A;<p><em><a href="https://semver.org/#how-do-i-know-when-to-release-100">https://semver.org/#how-do-i-know-when-to-release-100</a></em></p>&#x000A;&#x000A;<p><strong>I was so proud and excited about this ability to use Ruby for frontend code!</strong> I was writing the logic for an in-page product filter and Ruby allowed me to solve the problem quickly, with its signature concise syntax, and leveraging the power of enumerable. That immensely reduced the lines of code I had to write and allowed me to concentrate on just the core of the problem.</p>&#x000A;&#x000A;<p>Many years have passed, and I&#39;m even more proud of the project that Opal has become, the maturity and the feature parity with MRI is astounding, the new features that are coming in version 1.0 are even more amazing, and the roadmap ahead <strong>makes Opal one of the best choices among compile-to-JS languages</strong>.</p>&#x000A;&#x000A;<a href="/blog/2019/05/12/opal-1-0/#continue-reading">continue reading…</a></div>
</article>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2019/02/05/opal-rspec-0-7/'>
Opal-RSpec v0.7, has been finally released! ✨
</a>
</h2>
<div class='blog-post-meta'>
Posted by Elia Schito
<br>
February 05, 2019
</div>
</header>
<div class='blog-post-body'>
<p>It&#39;s been a deep work of refactoring and rewriting, adding specs and updating dependencies. Huge kudos to <a href="https://github.com/wied03">@wied03</a> for the foundational work and as usual to <a href="https://github.com/iliabylich">@iliabylich</a> for the laser sharp refactoring.</p>&#x000A;&#x000A;<p><em>For a full list of changes and updated instructions please checkout the <a href="https://github.com/opal/opal-rspec/blob/master/CHANGELOG.md#071---2019-02-04">Changelog</a> and the <a href="https://github.com/opal/opal-rspec#readme">Readme</a>.</em></p>&#x000A;&#x000A;<a href="/blog/2019/02/05/opal-rspec-0-7/#continue-reading">continue reading…</a></div>
</article>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2017/12/20/opal-0-11-0/'>
Opal 0.11.0: Parser gem, Safe navigator (&.), Random seed support, Constant lookup
</a>
</h2>
<div class='blog-post-meta'>
Posted by Elia Schito
<br>
December 20, 2017
</div>
</header>
<div class='blog-post-body'>
<p>Hello everyone!</p>&#x000A;&#x000A;<p>I&#39;m very happy to announce that after more than a year in the making Opal v0.11.0 has finally been released!</p>&#x000A;&#x000A;<p>This version is probably the last one before 1.0, it&#39;s packed with great new features, a ton of fixes and a complete reimplementation of the parser.</p>&#x000A;&#x000A;<h2 id="notable-changes-since-opal-v0-10-0">Notable Changes since Opal v0.10.0</h2>&#x000A;&#x000A;<a href="/blog/2017/12/20/opal-0-11-0/#continue-reading">continue reading…</a></div>
</article>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2016/07/19/opal-rspec-0-5/'>
Opal-RSpec 0.5: Newer RSpec version, improved Rake task, better documentation
</a>
</h2>
<div class='blog-post-meta'>
Posted by Brady Wied
<br>
July 19, 2016
</div>
</header>
<div class='blog-post-body'>
<h1 id="opal-rspec">Opal-RSpec</h1>&#x000A;&#x000A;<p>If you&#39;re a Rubyist, you know about RSpec. It&#39;s the testing framework that most of us like. RSpec&#39;s code base also happens to use a lot of features of the Ruby language, which means getting it to work on Opal is a challenge, but to some extent, we&#39;re there! Even if you&#39;re writing code in ES5/ES6, you might enjoy using RSpec as an alternative to Jasmine. Opal&#39;s native JS functionality makes that fairly easy to do.</p>&#x000A;&#x000A;<h2 id="whats-new">What&#39;s new?</h2>&#x000A;&#x000A;<p>There were 394 commits since opal-rspec 0.4.3 that covered a variety of areas:</p>&#x000A;&#x000A;<ul>&#x000A;<li>Opal itself - 30+ pull requests went into Opal 0.9 to improve RSpec&#39;s stability on Opal. This obviously benefits anyone using opal, not just opal-rspec users.</li>&#x000A;<li>RSpec specs - opal-rspec 0.5 now runs and passes 80%+ of RSpec&#39;s own specs. For the first time, limitations, including some present in prior opal-rspec versions, are documented.</li>&#x000A;<li>New versions - Base RSpec version has been upgraded to 3.1 from the 3.0 beta (we know we&#39;re still behind, but read on) and the Rake task works with Phantom JS 1.9.8 and 2.0.</li>&#x000A;<li>New features - Node runner support and improved Rake task configurability.</li>&#x000A;</ul>&#x000A;&#x000A;<h2 id="how-do-you-get-started">How do you get started?</h2>&#x000A;&#x000A;<p>First step is adding it to your <code>Gemfile</code> and <code>bundle install</code>.</p>&#x000A;<div class="highlight"><pre class="highlight ruby"><code><span class="n">gem</span> <span class="s1">'opal-rspec'</span>&#x000A;</code></pre></div>&#x000A;<p>Then you&#39;ll need to ensure, for the default config, you have at 1.9.8 of PhantomJS installed.</p>&#x000A;&#x000A;<p>Then you can start writing specs!</p>&#x000A;&#x000A;<p>Put this in <code>spec/42_spec.rb</code></p>&#x000A;<div class="highlight"><pre class="highlight ruby"><code><span class="n">describe</span> <span class="mi">42</span> <span class="k">do</span>&#x000A;  <span class="n">subject</span> <span class="p">{</span> <span class="mi">43</span> <span class="p">}</span>&#x000A;&#x000A;  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="n">eq</span> <span class="mi">43</span> <span class="p">}</span>&#x000A;<span class="k">end</span>&#x000A;</code></pre></div>&#x000A;<p>Then in your Rakefile:</p>&#x000A;<div class="highlight"><pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'opal/rspec/rake_task'</span>&#x000A;<span class="no">Opal</span><span class="o">::</span><span class="no">RSpec</span><span class="o">::</span><span class="no">RakeTask</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">:default</span><span class="p">)</span>&#x000A;</code></pre></div>&#x000A;<p>After running <code>bundle exec rake</code>, you&#39;ll see:</p>&#x000A;<div class="highlight"><pre class="highlight ruby"><code><span class="no">Running</span> <span class="n">phantomjs</span> <span class="sr">/usr/</span><span class="n">local</span><span class="o">/</span><span class="n">bundle</span><span class="o">/</span><span class="n">gems</span><span class="o">/</span><span class="n">opal</span><span class="o">-</span><span class="n">rspec</span><span class="o">-</span><span class="mf">0.5</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">vendor</span><span class="o">/</span><span class="n">spec_runner</span><span class="p">.</span><span class="nf">js</span> <span class="s2">"http://localhost:9999/"</span>&#x000A;<span class="no">Object</span> <span class="n">freezing</span> <span class="n">is</span> <span class="n">not</span> <span class="n">supported</span> <span class="n">by</span> <span class="no">Opal</span>&#x000A;&#x000A;<span class="o">.</span>&#x000A;&#x000A;<span class="no">Finished</span> <span class="k">in</span> <span class="mf">0.013</span> <span class="n">seconds</span> <span class="p">(</span><span class="n">files</span> <span class="n">took</span> <span class="mf">0.163</span> <span class="n">seconds</span> <span class="n">to</span> <span class="nb">load</span><span class="p">)</span>&#x000A;<span class="mi">1</span> <span class="n">example</span><span class="p">,</span> <span class="mi">0</span> <span class="n">failures</span>&#x000A;</code></pre></div>&#x000A;<p>Right off the bat, you can see at least a few things Opal doesn&#39;t like about RSpec&#39;s code base (the freeze warning), but as of opal-rspec 0.5, those are either limited to this warning message or other documented limitations.</p>&#x000A;&#x000A;<p>Formatter support works as well.</p>&#x000A;&#x000A;<p>After running <code>SPEC_OPTS=&quot;--format json&quot; bundle exec rake</code>:</p>&#x000A;<div class="highlight"><pre class="highlight plaintext"><code>Object freezing is not supported by Opal&#x000A;&#x000A;{"examples":[{"description":"should eq 43", "full_description":"42 should eq 43", "status":"passed", "file_path":"http://localhost", "line_number":9999, "run_time":0.005}], "summary":{"duration":0.013, "example_count":1, "failure_count":0, "pending_count":0}, "summary_line":"1 example, 0 failures"}&#x000A;</code></pre></div>&#x000A;<h2 id="asynchronous-testing-on-opal">Asynchronous testing on Opal</h2>&#x000A;&#x000A;<p>Since opal has a promise implementation built in, opal-rspec has some support for asynchronous testing. By default, any <code>subject</code>, <code>it</code> block, <code>before(:each)</code>, <code>after(:each)</code>, or <code>around</code> hook that returns a promise will cause RSpec to wait for promise resolution before continuing. In the <code>subject</code> case, any <code>subject</code> resolution in your specs will be against the promise result, not the promise, which should DRY up your specs.</p>&#x000A;&#x000A;<p>Example:&#x000A;Create <code>spec/async_spec.rb</code> with this content:</p>&#x000A;<div class="highlight"><pre class="highlight ruby"><code><span class="n">describe</span> <span class="s1">'async'</span> <span class="k">do</span>&#x000A;  <span class="n">subject</span> <span class="k">do</span>&#x000A;    <span class="n">promise</span> <span class="o">=</span> <span class="no">Promise</span><span class="p">.</span><span class="nf">new</span>&#x000A;    <span class="n">delay</span> <span class="mi">1</span> <span class="k">do</span>&#x000A;      <span class="n">promise</span><span class="p">.</span><span class="nf">resolve</span> <span class="mi">42</span>&#x000A;    <span class="k">end</span>&#x000A;    <span class="n">promise</span>&#x000A;  <span class="k">end</span>&#x000A;&#x000A;  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="n">be_a</span> <span class="no">Promise</span> <span class="p">}</span>&#x000A;  <span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="p">.</span><span class="nf">to</span> <span class="n">eq</span> <span class="mi">42</span> <span class="p">}</span>&#x000A;<span class="k">end</span>&#x000A;</code></pre></div>&#x000A;<p>Result:</p>&#x000A;<div class="highlight"><pre class="highlight plaintext"><code>Running phantomjs /usr/local/bundle/gems/opal-rspec-0.5.0/vendor/spec_runner.js "http://localhost:9999/"&#x000A;Object freezing is not supported by Opal&#x000A;&#x000A;.F.&#x000A;&#x000A;Failures:&#x000A;&#x000A;  1) async should be a kind of Promise&#x000A;     Failure/Error: Unable to find matching line from backtrace&#x000A;     Exception::ExpectationNotMetError:&#x000A;       expected 42 to be a kind of Promise&#x000A;     # ExpectationNotMetError: expected 42 to be a kind of Promise&#x000A;     #     at http://localhost:9999/assets/opal/rspec/sprockets_runner.js:4294&#x000A;     #     at http://localhost:9999/assets/opal/rspec/sprockets_runner.js:50378&#x000A;     #     at http://localhost:9999/assets/opal/rspec/sprockets_runner.js:33927&#x000A;     #     at http://localhost:9999/assets/opal/rspec/sprockets_runner.js:33950&#x000A;     #     at http://localhost:9999/assets/opal/rspec/sprockets_runner.js:33708&#x000A;     #     at http://localhost:9999/assets/opal/rspec/sprockets_runner.js:53200&#x000A;     #     at http://localhost:9999/assets/opal/rspec/sprockets_runner.js:3000&#x000A;     #     at http://localhost:9999/assets/opal/rspec/sprockets_runner.js:52274&#x000A;     #     at http://localhost:9999/assets/opal/rspec/sprockets_runner.js:52348&#x000A;     #     at http://localhost:9999/assets/opal/rspec/sprockets_runner.js:1055&#x000A;     #     at http://localhost:9999/assets/opal/rspec/sprockets_runner.js:14805&#x000A;     #     at http://localhost:9999/assets/opal/rspec/sprockets_runner.js:52554&#x000A;     #     at http://localhost:9999/assets/opal/rspec/sprockets_runner.js:52573&#x000A;     #     at http://localhost:9999/assets/opal/rspec/sprockets_runner.js:52555&#x000A;     #&#x000A;     #   Showing full backtrace because every line was filtered out.&#x000A;     #   See docs for RSpec::Configuration#backtrace_exclusion_patterns and&#x000A;     #   RSpec::Configuration#backtrace_inclusion_patterns for more information.&#x000A;&#x000A;Finished in 2.03 seconds (files took 0.156 seconds to load)&#x000A;3 examples, 1 failure&#x000A;&#x000A;Failed examples:&#x000A;&#x000A;rspec http://localhost:9999 # async should be a kind of Promise&#x000A;</code></pre></div>&#x000A;<p>The failure is because we get a number back, not a Promise.</p>&#x000A;&#x000A;<h2 id="other-new-tools-in-the-ecosystem">Other new tools in the ecosystem</h2>&#x000A;&#x000A;<h3 id="junit-teamcity-rubymine-formatter-support">JUnit &amp; TeamCity/Rubymine formatter support</h3>&#x000A;&#x000A;<p>The chances are your CI tool supports at least 1 of those. Check out <a href="https://github.com/wied03/opal-rspec-formatter">opal-rspec-formatter</a></p>&#x000A;&#x000A;<h3 id="karma-support">Karma support</h3>&#x000A;&#x000A;<p>If you want to tap into the browser runners that Karma supports but keep using Opal, you might want to check out <a href="https://github.com/wied03/karma-opal-rspec">karma-opal-rspec</a>.</p>&#x000A;&#x000A;<h2 id="work-to-be-done">Work to be done</h2>&#x000A;&#x000A;<p>As was mentioned above, we&#39;re still using RSpec 3.1, which as of this writing, is almost 1.5 years old. Due to the number of changes necessary to make RSpec Opal friendly, we cannot track with RSpec releases as fast as we would like. That said, several things we&#39;re doing should allow us to move faster in the future, including:</p>&#x000A;&#x000A;<ul>&#x000A;<li>Constantly improving Opal code base that allows more Ruby features to work out of the box.</li>&#x000A;<li>RSpec specs which helped improve Opal and allow us to easily identify far corners of RSpec&#39;s functionality.</li>&#x000A;<li>Work on arity checking is already in-progress (opal-rspec currently doesn&#39;t run with arity checking enabled). This will tease out even more issues.</li>&#x000A;</ul>&#x000A;&#x000A;<p>All of these will eventually lead to less monkey patching and more out of the box stuff that works.</p>&#x000A;&#x000A;<h2 id="how-to-help">How to help</h2>&#x000A;&#x000A;<p>Arity checking is the top priority right now. If you can assist with issues like <a href="https://github.com/opal/opal/issues/1237">this opal issue</a> that are documented on the opal-rspec <a href="https://github.com/opal/opal-rspec/issues/40">arity check issue</a>, that will help move things along.</p>&#x000A;&#x000A;<p>After that is complete, we can begin work on RSpec 3.4.</p>&#x000A;</div>
</article>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2016/06/23/opal-0-10/'>
Opal 0.10: Rack 2 compatibility, improved keyword argument support, better source maps, and a whole lot more
</a>
</h2>
<div class='blog-post-meta'>
Posted by Jared White
<br>
June 23, 2016
</div>
</header>
<div class='blog-post-body'>
<p>Opal is now officially on the 0.10.x release path. Thanks to all the <a href="https://github.com/opal/opal/graphs/contributors?from=2016-01-14&amp;to=2016-06-23&amp;type=c">contributors to Opal</a> who&#39;ve worked hard to make this release possible. Some highlights from the latest release:</p>&#x000A;&#x000A;<ul>&#x000A;<li>Improvements to source maps</li>&#x000A;<li>Updates to methods in Array, Enumerable, and Module for RubySpec compliance</li>&#x000A;<li>Rack v2 compatibility</li>&#x000A;<li>Support for keyword arguments as lambda parameters, as well as keyword splats</li>&#x000A;<li>Some IO enhancements to better work with Node.js</li>&#x000A;<li>Marshalling support&#x000A;<a href="/blog/2016/06/23/opal-0-10/#continue-reading">continue reading…</a></div>
</article>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2016/01/13/opal-0-9/'>
Opal 0.9: direct JS calls, console.rb, numeric updates, better reflection, and fixes aplenty
</a>
</h2>
<div class='blog-post-meta'>
Posted by Jared White
<br>
January 13, 2016
</div>
</header>
<div class='blog-post-body'>
<p>Opal is now officially on the 0.9.x release path, having just released <a href="https://github.com/opal/opal/compare/v0.8.1...v0.9.2">0.9.2</a>. Thanks to all the <a href="https://github.com/opal/opal/graphs/contributors?from=2015-04-30&amp;to=2016-01-13&amp;type=c">contributors to Opal</a>, especially over the holidays, and we&#39;re excited for what the new year will bring to the Opal community. Some highlights from the latest release:</p>&#x000A;&#x000A;<h3 id="direct-calling-of-javascript-methods">Direct calling of JavaScript methods</h3>&#x000A;&#x000A;<p>You can now make direct JavaScript method calls on native JS objects using the <code>recv.JS.method</code> syntax. Has support for method calls, final callback (as a block), property getter and setter (via <code>#[]</code> and <code>#[]=</code>), splats, JavaScript keywords (via the <code>::JS</code> module) and global functions (after <code>require &quot;js&quot;</code>).</p>&#x000A;&#x000A;<a href="/blog/2016/01/13/opal-0-9/#continue-reading">continue reading…</a></div>
</article>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2015/02/02/opal-0-7-0/'>
Opal 0.7.0: require, kwargs, docs, testing, lots of fixes
</a>
</h2>
<div class='blog-post-meta'>
Posted by Elia Schito
<br>
February 02, 2015
</div>
</header>
<div class='blog-post-body'>
<p>It&#39;s been almost a year from our 0.6.0 release and has been an awesome time for the Opal community. Today I&#39;m proud to announce we have released v0.7.0, which comes packed with lots of good stuff and uncountable bug fixes.</p>&#x000A;&#x000A;<h3 id="require-require_relative-and-require_tree">#require #require_relative and #require_tree</h3>&#x000A;&#x000A;<p>The require system has been completely overhauled in Opal 0.7. The previous version was a rather <a href="https://github.com/opal/opal/blob/master/lib/opal/nodes/call.rb#L164-L169">smart</a> wrapper around <a href="https://github.com/sstephenson/sprockets#the-directive-processor">sprockets directives</a> but had some limitations, especially when it came to interleaving require calls and code. Some gems couldn&#39;t be compiled with Opal just for that reason.</p>&#x000A;&#x000A;<p>The new require system now relies on a module repository where each &quot;module&quot; actually corresponds to a Ruby file compiled with Opal. This means that <code>#require</code> calls aren&#39;t <em>no-ops</em> anymore.</p>&#x000A;&#x000A;<p>In addition to that <code>#require_relative</code> support has been added and for feature parity with sprockets directives we&#39;re also introducing <code>#require_tree</code>. The latter will be particularly useful to require templates.</p>&#x000A;&#x000A;<h3 id="keyword-arguments">Keyword Arguments</h3>&#x000A;&#x000A;<p>This has been a super requested feature, and thanks to <a href="https://github.com/adambeynon">Adam Beynon</a> they&#39;re now a reality. They still have some rough edges (as they did in their first CRuby/MRI incarnation) but the core is there for you all to enjoy.</p>&#x000A;&#x000A;<a href="/blog/2015/02/02/opal-0-7-0/#continue-reading">continue reading…</a></div>
</article>

<article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href='/blog/2014/05/07/promises-in-opal/'>
Promises: Handling asynchronous code in Opal
</a>
</h2>
<div class='blog-post-meta'>
Posted by Adam Beynon
<br>
May 07, 2014
</div>
</header>
<div class='blog-post-body'>
<p>When using Opal, one large omission from the stdlib are Threads. This is because javascript does not have threads, which makes asyncronous programming difficult in ruby. As javascript has increased in popularity with DOM libraries and web frameworks, callback hell was the standard way to handle asynchronous events in javascript. This was also the way events were handled in Opal applications. Until now.</p>&#x000A;&#x000A;<h3 id="what-is-so-great-about-promises">What is so great about promises?</h3>&#x000A;&#x000A;<p>When looking at a simple example, the benefits of promises may not be obvious:</p>&#x000A;<div class="highlight"><pre class="highlight ruby"><code><span class="c1"># old callback method</span>&#x000A;<span class="no">HTTP</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s2">"url"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">response</span><span class="o">|</span>&#x000A;  <span class="nb">puts</span> <span class="s2">"got response"</span>&#x000A;<span class="k">end</span>&#x000A;&#x000A;<span class="c1"># using promises</span>&#x000A;<span class="no">HTTP</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s2">"url"</span><span class="p">).</span><span class="nf">then</span> <span class="k">do</span> <span class="o">|</span><span class="n">response</span><span class="o">|</span>&#x000A;  <span class="nb">puts</span> <span class="s2">"got response"</span>&#x000A;<span class="k">end</span>&#x000A;</code></pre></div>&#x000A;<p>Initially the method call using a <code>Promise</code> looks just a more verbose version of the standard callback approach. The benefit of promises come through when promises are chained together. The result of the <code>#then</code> call actually returns a new <code>Promise</code> instance, which will not be resolved until the result of the first block resolves itself.</p>&#x000A;&#x000A;<h4 id="callback-hell">Callback hell</h4>&#x000A;&#x000A;<p>Lets take a slightly more complex example where an initial HTTP request is made for some user details, and then a second request is made using the result of the first json response:</p>&#x000A;&#x000A;<a href="/blog/2014/05/07/promises-in-opal/#continue-reading">continue reading…</a></div>
</article>

</div>
</div>

  </div>

  <footer>
  <a href="/license"><i class="ion-unlocked"></i> License</a> ·
  <a href="https://github.com/opal/opal/graphs/contributors"><i class="ion-fork-repo"></i> Contributors</a>
</footer>


  <script>
    document.querySelector(`a[href="${location.pathname.replace(/\/$/,'')}"]`)?.parentElement.classList.add("active")
  </script>

  <!-- Algolia -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
  <script type="text/javascript">
    docsearch({
      apiKey: 'cf08db1eca77cb92ca34e24a86430bcb',
      indexName: 'opalrb',
      inputSelector: '#search-form input[type="search"]',
      debug: false // Set debug to true if you want to inspect the dropdown
    });
  </script>
</body>
</html>
