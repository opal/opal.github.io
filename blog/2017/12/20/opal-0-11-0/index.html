<!doctype html>
<html style="background-color: #f5f5f5; min-height: 100%;">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <title>Opal 0.11.0: Parser gem, Safe navigator (&.), Random seed support, Constant lookup</title>

  <link href="/assets/application-915b7e3cafe6e192dee011fa09837b2af85b7e1de3dbb52fd1413d46dd2dca0e.css" rel="stylesheet" />
  <link href="//code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" rel="stylesheet" />

  <script src="/assets/application-596f523b41cd0c1b75b8066512c4c9b592e85ce699428a05db4d6ac425c2b09f.js" onload="Opal.loaded(typeof(OpalLoaded) === &quot;undefined&quot; ? [] : OpalLoaded);
Opal.require(&quot;application&quot;);;console.log('loaded application')"></script>

  <!-- Algolia -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
</head>
<body class="blog blog_2017 blog_2017_12 blog_2017_12_20 blog_2017_12_20_opal-0-11-0 blog_2017_12_20_opal-0-11-0_index">
  <nav class='navbar navbar-default opal-nav' role='navigation'>
<div class='container'>
<div class='navbar-header'>
<a class='navbar-brand' href='/'>
<img height='22' src='https://secure.gravatar.com/avatar/88298620949a6534d403da2e356c9339?s=420&amp;d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png' style='margin-top:-10%;' width='22'>
Opal
</a>
<button class='navbar-toggle' data-target='#opal-navbar' data-toggle='collapse' type='button'>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
</button>
</div>
<div class='navbar-collapse collapse' id='opal-navbar'>
<ul class='nav navbar-nav'>
<li>
<a href='/try'>
<i class='ion-ios-compose'></i>
Try
</a>
</li>
<li>
<a href='/blog'>
<i class='ion-ios-chatboxes'></i>
Blog
</a>
</li>
<li>
<a href='/docs'>
<i class='ion-ios-copy'></i>
Documentation
</a>
</li>
<li>
<a href='/libraries'>
<i class='ion-map'></i>
Libraries
</a>
</li>
<li>
<a href='https://github.com/opal/opal#readme'>
<i class='ion-social-github'></i>
GitHub
</a>
</li>
<li>
<a href='https://rubygems.org/gems/opal/versions/1.8.2' style='opacity: 0.5;'>
v1.8.2
</a>
</li>
</ul>
<ul class='nav navbar-right'>
<li class='search-bar'>
<form id='search-form'>
<input placeholder='Search docs &amp; guides' type='search'>
<button title='Clear the search query.' type='reset'>
&times;
</button>
</form>
</li>
</ul>
</div>
</div>
</nav>


  <div class="container">
      <div class="container col-sm-8">
    <div class='blog-title'>
<h1>
<a href='/blog'>The Opal Blog</a>
</h1>
</div>

    <article class='blog-post'>
<header>
<h2 class='blog-post-title'>
<a href=''>
Opal 0.11.0: Parser gem, Safe navigator (&.), Random seed support, Constant lookup
</a>
</h2>
<div class='blog-post-meta'>
Posted by Elia Schito
<br>
December 20, 2017
</div>
</header>
<div class='blog-post-body'>
<p>Hello everyone!</p>&#x000A;&#x000A;<p>I&#39;m very happy to announce that after more than a year in the making Opal v0.11.0 has finally been released!</p>&#x000A;&#x000A;<p>This version is probably the last one before 1.0, it&#39;s packed with great new features, a ton of fixes and a complete reimplementation of the parser.</p>&#x000A;&#x000A;<h2 id="notable-changes-since-opal-v0-10-0">Notable Changes since Opal v0.10.0</h2>&#x000A;&#x000A;<div id="continue-reading"></div>&#x000A;&#x000A;<h3 id="renewed-parser">Renewed parser</h3>&#x000A;&#x000A;<p>The new parser is much stricter, so expect some code that was happily parsed to be rejected.&#x000A;The good news is your code will be even closer to the standard, and the parser&#39;s error messages are generally better and will tell you exactly where the syntax error is.</p>&#x000A;&#x000A;<h3 id="constant-lookup">Constant lookup</h3>&#x000A;&#x000A;<p>The constant lookup system has been rewritten and now the algorithm is closer to what MRI does while still taking advantage of an aggressive cache.</p>&#x000A;&#x000A;<h3 id="sprockets-extraction">Sprockets extraction</h3>&#x000A;&#x000A;<p><code>Opal::Server</code> was relying on Sprockets which is now extracted to the resurrected <code>opal-sprockets</code> gem and can be found under <code>Opal::Sprockets::Server</code>.</p>&#x000A;&#x000A;<p>The <code>opal</code> gem still provides a basic server which can be accessed as <code>Opal::SimpleServer</code>. The simple server uses the internal <code>Opal::Builder</code> instead of Sprockets and has kept the same API where possible.</p>&#x000A;&#x000A;<h3 id="headless-chrome">Headless Chrome</h3>&#x000A;&#x000A;<p>Headless Chrome is the new standard, while <code>phantomjs</code> has been officially abandoned.</p>&#x000A;&#x000A;<p>Opal v0.11.0 replaced the <code>phantomjs</code> CLI runner with <code>chrome</code>. While there&#39;s no plan to restore support for <code>phantomjs</code> if your app really needs it please contact the core team on <a href="https://github.com/opal/opal/issues/new">GitHub</a> or <a href="https://slack.opalrb.com">Slack</a>, if there&#39;s enough interest we&#39;ll do our best to extract and publish <code>phantomjs</code> runner code as an external gem.</p>&#x000A;&#x000A;<h3 id="dynamic-requires">Dynamic requires</h3>&#x000A;&#x000A;<p>Pre-compiling Ruby into JavaScript doesn&#39;t go along well with dynamic calls to <code>require</code>, but Opal <a href="https://github.com/opal/opal/blob/v0.11.0/lib/opal/nodes/call.rb#L311-L364">goes out of its way</a> to infer the required path (e.g. it parses calls to <code>File.expand_path</code> and resolves them at compile time).</p>&#x000A;&#x000A;<p>Previously whenever a call to <code>require</code> couldn&#39;t be resolved it ended in raising an exception and blocked the compilation, often unnecessarily forcing the user to add the requested path to stubs (see the <code>Opal::Config</code> documentation).</p>&#x000A;&#x000A;<p>With Opal v0.11.0 calls to <code>require</code> that cannot be resolved at compile time will just be ignored and will raise a  <code>LoadError</code> at runtime if the given path still isn&#39;t found. This is closer to what happens under MRI. It&#39;s still possible to revert back to the old behavior by settings <code>Opal::Config.dynamic_require_severity = :error</code> (see the relevant code in <a href="https://github.com/opal/opal/blob/v0.11.0/lib/opal/config.rb#L101-L108">opal/config.rb</a>).</p>&#x000A;&#x000A;<h3 id="read-the-changelog-for-further-details">Read the Changelog for further details</h3>&#x000A;&#x000A;<p>As always, Opal v0.11.0 includes many bug fixes and improvements to the internals of the Opal libraries, so be sure to <a href="https://github.com/opal/opal/blob/0-11-stable/CHANGELOG.md">read the changelog</a> for further details.</p>&#x000A;&#x000A;<hr>&#x000A;&#x000A;<p>As always, huge thanks to the many contributors who helped with this release.</p>&#x000A;&#x000A;<p><em>Link to the official chat updated on 2020/04/28.</em></p>&#x000A;</div>
</article>

  </div>

  </div>

  <footer>
  <a href="/license"><i class="ion-unlocked"></i> License</a> Â·
  <a href="https://github.com/opal/opal/graphs/contributors"><i class="ion-fork-repo"></i> Contributors</a>
</footer>


  <script>
    document.querySelector(`a[href="${location.pathname.replace(/\/$/,'')}"]`)?.parentElement.classList.add("active")
  </script>

  <!-- Algolia -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
  <script type="text/javascript">
    docsearch({
      apiKey: 'cf08db1eca77cb92ca34e24a86430bcb',
      indexName: 'opalrb',
      inputSelector: '#search-form input[type="search"]',
      debug: false // Set debug to true if you want to inspect the dropdown
    });
  </script>
</body>
</html>
